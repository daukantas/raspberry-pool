{"version":3,"sources":["../../../src/modules/raspberries/controller.server.js"],"names":["raspberriesDescriptor","raspberriesManager","index","ctx","raspberries","state","connected","getAll","user","render","screenshot","stats","screenshotPath","query","id","__dirname"],"mappings":";;;;;;AAAA;;AACA;;;;AACA;;IAAYA,qB;;AACZ;;IAAYC,kB;;;;;;;;kBAEG,wBAAc;AAC3BC,QAAMC,GAAN,EAAW;AACT,UAAMC,cAAc,CAACD,IAAIE,KAAJ,CAAUC,SAAX,QAA4BL,mBAAmBM,MAAnB,CAA0BJ,IAAIE,KAAJ,CAAUG,IAApC,CAAhD;AACA,WAAOL,IAAIM,MAAJ,CAAWT,qBAAX,EAAkC,EAAEI,WAAF,EAAlC,CAAP;AACD,GAJ0B;;AAM3BM;AAAA,iCAAY,WAAOP,GAAP,EAAe;AACzB,YAAMQ,QAAQ,MAAM,2BAAKR,GAAL,EAAUF,mBAAmBW,cAAnB,CAAkCT,IAAIU,KAAJ,CAAUC,EAA5C,CAAV,CAApB;AACA,UAAI,CAACH,KAAL,EAAY;AACV,cAAM,2BAAKR,GAAL,EAAW,IAAEY,SAAU,gCAAvB,CAAN;AACD;AACF,KALD;;AAAA;AAAA;AAAA;AAAA;AAN2B,CAAd,C","file":"controller.server.js","sourcesContent":["import { newController } from 'alp';\nimport send from 'koa-sendfile';\nimport * as raspberriesDescriptor from './';\nimport * as raspberriesManager from './raspberriesManager.server';\n\nexport default newController({\n  index(ctx) {\n    const raspberries = !ctx.state.connected ? [] : raspberriesManager.getAll(ctx.state.user);\n    return ctx.render(raspberriesDescriptor, { raspberries });\n  },\n\n  screenshot: async (ctx) => {\n    const stats = await send(ctx, raspberriesManager.screenshotPath(ctx.query.id));\n    if (!stats) {\n      await send(ctx, `${__dirname}/../../../public/logo-210.jpg`);\n    }\n  },\n});\n"]}